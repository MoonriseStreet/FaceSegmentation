# FaceSegmentation

![This is an image](pic.png)

### Задание

Предлагается решить задачу семантической сегментации атрибутов лица человека. В качестве датасета будет использоваться [CelebAMask-HQ](https://github.com/switchablenorms/CelebAMask-HQ). Выборка из датасета представлена в [файле](train_test_split-10e5aa2b-26ae-4110-b7a6-2beed2c7da6a.csv).

В этом репозитории представлено моё решение задачи.


### Проведённая работа

Так как даже в 512x512 сложно что-либо делать с картинками, не перегружая оперативку колаба, пришлось уменьшить разрешение до 128x128.


В [ноутбуке](faces.ipynb) находится подробное описание построенных моделей. Для решения задачи используется библиотека `segmentation_models`. В качестве архитектуры выбрана Unet, в которую загружены предобученные веса. Модель обучалась определять класс `hair`. Результаты работы можно увидеть в ноутбуке, обученная модель достаточно правильно выделяет области в большинстве не слишком сложных случаев. Если продолжить обучение, вероятно, получится довольно точный алгоритм.

Использовать аугментации здесь не имеет особого смысла, так как во-первых данных достаточно, во вторых датасет достаточно однороден и сейчас нет цели научиться распознавать объекты с помехами. Кроме, того это еще сильнее замедлит обучение. 

В [другом ноутбуке](faces1.ipynb) выполняется тот же код, но с использованием архитектуры Linknet. Модель обучается быстрее, но её метрики хуже, что заметно и на примерах. Из этого не следует, что одна модель хуже другой, но провести сколько-нибудь разумное исследование о том, какую из моделей лучше использовать я не успею.


### Воспроизведение кода

Чтобы воспроизвести выполнение кода, нужно:

0. Убедиться в том, что у вас установлен `Python3` и библиотеки из [`requirements.txt`](requirements.txt).
1. Скачать датасет [CelebAMask-HQ](https://github.com/switchablenorms/CelebAMask-HQ) и распаковать.
2. В той же директории выполнить код из [файла](preprocess.py), после этого будет создана новая директория `CelebAMask` с выборкой картинок для обучения, сжатых до размер 128x128.
3. Выполнить [ноутбук](faces.ipynb).

Загрузить модели на гитхаб не могу, они по 250 Мб весят, а у меня интернет очень слабый(((